<!DOCTYPE html>
<html lang="en">
<head>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
        body { margin: 0; background-color: #f4f4f4; display: flex; flex-direction: column; height: 100vh; font-family: 'Segoe UI', sans-serif; }
        .viewer-container { position: relative; width: 100%; flex-grow: 1; overflow: hidden; }
        
        /* Layer 1: The Room (Background) - Camera is LOCKED */
        #room-layer { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; 
            pointer-events: none; /* Prevents user from moving the room */
        }
        
        /* Layer 2: The Sofa (Foreground) */
        #sofa-layer { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; 
            pointer-events: none; /* We use the slider for rotation, not drag */
        }

        .controls { 
            background: white; padding: 20px; text-align: center; 
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1); z-index: 10;
            display: flex; flex-direction: column; align-items: center; gap: 15px;
        }
        select { padding: 12px 20px; font-size: 16px; border-radius: 8px; border: 1px solid #ccc; width: 300px; cursor: pointer; }
        input[type=range] { width: 300px; cursor: pointer; }
        label { font-size: 14px; font-weight: bold; color: #333; }
    </style>
</head>
<body>

<div class="viewer-container">
    <model-viewer id="room-layer" 
                  src="Room.glb" 
                  camera-orbit="90deg 85deg 14m" 
                  disable-zoom 
                  interaction-prompt="none"
                  exposure="1" 
                  shadow-intensity="1">
    </model-viewer>
    
    <model-viewer id="sofa-layer" 
                  src="Sofa1.glb" 
                  camera-orbit="90deg 85deg 14m"
                  exposure="1" 
                  shadow-intensity="1.5">
    </model-viewer>
</div>

<div class="controls">
    <div>
        <label>1. Select Furniture:</label><br>
        <select id="config-select">
            <option value="sofa1">Option 1: Orange 2-Seater</option>
            <option value="sofa2">Option 2: White Armchair</option>
            <option value="sofa5">Option 3: Brown Chesterfield</option>
            <option value="sofa6">Option 4: Grey Sofa</option>
        </select>
    </div>
    
    <div>
        <label>2. Rotate Furniture:</label><br>
        <input type="range" id="rotate-slider" min="-180" max="180" step="5" value="0">
    </div>
</div>

<script>
    // --- YOUR EXTRACTED PARAMETERS ---
    const sofaData = {
        // Sofa 1 (Orange 2-Seater)
        'sofa1': { 
            file: 'Sofa1.glb', 
            scale: '0.5001 0.5001 0.5001', 
            position: '-75.7m 2m 25.7m', 
            baseRotation: 0 
        },
        
        // Sofa 2 (White Armchair)
        'sofa2': { 
            file: 'Sofa2.glb', 
            scale: '0.1383 0.1383 0.1383', 
            position: '27.6m 20.4m 10.5m', 
            baseRotation: -1 
        },

        // Sofa 5 (Brown Chesterfield)
        'sofa5': { 
            file: 'Sofa5.glb', 
            scale: '0.6251 0.6251 0.6251', 
            position: '-100m 100m 100m', 
            baseRotation: 0 
        },

        // Sofa 6 (Grey Sofa) - ROTATED 180 TO FACE WALL
        'sofa6': { 
            file: 'Sofa6.glb', 
            scale: '0.5001 0.5001 0.5001', 
            position: '-100m 29.6m 0m', 
            baseRotation: 180 // <--- Adjusted as requested
        }
    };

    const sofa = document.querySelector('#sofa-layer');
    const selector = document.querySelector('#config-select');
    const rotator = document.querySelector('#rotate-slider');

    // Function to update the model
    function updateSofa(key) {
        const data = sofaData[key];
        sofa.src = data.file;
        sofa.scale = data.scale;
        sofa.cameraTarget = data.position;
        
        // Reset slider to center (0) but apply the base rotation
        rotator.value = 0;
        sofa.orientation = `0deg ${data.baseRotation}deg 0deg`;
    }

    // 1. Handle Selection
    selector.addEventListener('change', (e) => {
        updateSofa(e.target.value);
    });

    // 2. Handle User Rotation
    rotator.addEventListener('input', (e) => {
        const userRot = parseInt(e.target.value);
        const currentKey = selector.value;
        const baseRot = sofaData[currentKey].baseRotation;
        
        // Add user rotation to the base rotation
        const totalRot = baseRot + userRot;
        sofa.orientation = `0deg ${totalRot}deg 0deg`;
    });

    // 3. Initialize with first option
    updateSofa('sofa1');
</script>

</body>
</html>
