<!DOCTYPE html>
<html lang="en">
<head>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
        body { margin: 0; background-color: #f4f4f4; display: flex; flex-direction: column; height: 100vh; font-family: 'Segoe UI', sans-serif; }
        .viewer-container { position: relative; width: 100%; flex-grow: 1; overflow: hidden; }
        
        /* Layer 1: The Room (Background) */
        #room-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        
        /* Layer 2: The Sofa (Foreground) */
        #sofa-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }

        .controls { 
            background: white; padding: 20px; text-align: center; 
            box-shadow: 0 -4px 20px rgba(0,0,0,0.1); z-index: 10;
        }
        select { padding: 12px 20px; font-size: 16px; border-radius: 8px; border: 1px solid #ccc; width: 300px; cursor: pointer; }
    </style>
</head>
<body>

<div class="viewer-container">
    <model-viewer id="room-layer" src="Room.glb" camera-controls disable-zoom exposure="1" shadow-intensity="1"></model-viewer>
    
    <model-viewer id="sofa-layer" src="Sofa2.glb" exposure="1" shadow-intensity="1.5"></model-viewer>
</div>

<div class="controls">
    <label for="config-select"><b>Select Sofa Configuration:</b></label><br><br>
    <select id="config-select">
        <option value="sofa2">Configuration A: Grey Fabric</option>
        <option value="sofa4">Configuration B: Vintage Style</option>
        <option value="sofa5">Configuration C: Office Style</option>
    </select>
</div>

<script>
    // --- FINAL CALIBRATED DATA ---
    const sofaData = {
        // Format: position: 'Xm Ym Zm' (Left/Right, Up/Down, Forward/Back)
        
        'sofa2': { 
            file: 'Sofa2.glb', 
            scale: '0.08 0.08 0.08', 
            position: '0m 6.0m 0m' // Set to 6.0m since you said >5. Adjust if needed.
        },
        
        'sofa4': { 
            file: 'Sofa4.glb', 
            scale: '1.11 1.11 1.11', 
            position: '0m 0.8m -4.7m' 
        },
        
        'sofa5': { 
            file: 'Sofa5.glb', 
            scale: '1.08 1.08 1.08', 
            position: '0m -0.5m -5.1m' 
        }
    };
    // -----------------------------

    const room = document.querySelector('#room-layer');
    const sofa = document.querySelector('#sofa-layer');
    const selector = document.querySelector('#config-select');

    // 1. Initialize with the first sofa's settings (Sofa 2)
    const initialData = sofaData['sofa2'];
    sofa.scale = initialData.scale;
    sofa.cameraTarget = initialData.position;

    // 2. Sync Camera Movements (Room dictates movement)
    room.addEventListener('camera-change', () => {
        sofa.cameraOrbit = room.cameraOrbit;
        sofa.fieldOfView = room.fieldOfView;
    });

    // 3. Handle Sofa Switching
    selector.addEventListener('change', (e) => {
        const key = e.target.value;
        const data = sofaData[key];

        // Change the file
        sofa.src = data.file;
        
        // Apply the specific calibration for that sofa
        sofa.scale = data.scale;
        sofa.cameraTarget = data.position; 
    });
</script>

</body>
</html>
