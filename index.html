<!DOCTYPE html>
<html lang="en">
<head>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
        body { margin: 0; background: #222; color: white; font-family: sans-serif; }
        .scene-wrapper { position: relative; width: 100vw; height: 100vh; overflow: hidden; }
        
        #room { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; }
        #sofa { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; pointer-events: none; }

        .dev-panel {
            position: absolute; bottom: 10px; left: 10px; z-index: 100;
            background: rgba(0,0,0,0.9); padding: 15px; border-radius: 8px; width: 320px;
            max-height: 90vh; overflow-y: auto; border: 1px solid #777;
        }
        .info-panel {
            position: absolute; top: 10px; left: 10px; z-index: 100;
            background: rgba(0, 0, 100, 0.8); padding: 10px; border-radius: 5px; pointer-events: none;
        }
        input[type=range] { width: 100%; margin-bottom: 5px; cursor: pointer; }
        label { font-size: 11px; color: #ccc; display: flex; justify-content: space-between; margin-top: 8px; }
        .val { color: #0f0; font-weight: bold; }
        select { width: 100%; padding: 8px; background: #333; color: white; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="info-panel">
    <b>üì∑ CAMERA ANGLE (LOCKED):</b><br>
    <span style="color:cyan; font-family: monospace;">90deg 89deg 12.37m</span>
</div>

<div class="scene-wrapper">
    <model-viewer id="room" 
                  src="Room.glb" 
                  camera-controls 
                  disable-zoom 
                  exposure="1" 
                  shadow-intensity="1"
                  camera-orbit="90deg 89deg 12.37m"
                  min-camera-orbit="90deg 89deg 0m"
                  max-camera-orbit="90deg 89deg 500m">
    </model-viewer>
    
    <model-viewer id="sofa" 
                  src="Sofa1.glb" 
                  exposure="1" 
                  camera-target="0m 0m 0m">
    </model-viewer>
</div>

<div class="dev-panel">
    <h3>üõ†Ô∏è Calibrator v8.2 (Expanded)</h3>
    <label>SELECT SOFA:</label>
    <select id="selector">
        <option value="sofa1">Sofa 1</option>
        <option value="sofa2">Sofa 2</option>
        <option value="sofa4">Sofa 4</option>
        <option value="sofa5">Sofa 5</option>
        <option value="sofa6">Sofa 6</option>
    </select>

    <label style="color:orange">1. Rotation: <span id="val-rot" class="val">0 deg</span></label>
    <input type="range" id="inp-rot" min="-180" max="180" step="1" value="0">

    <label>2. Size (Scale): <span id="val-scale" class="val">1.0</span></label>
    <input type="range" id="inp-scale" min="0.0001" max="2.0" step="0.0001" value="1">

    <label>3. Left/Right (X): <span id="val-x" class="val">0m</span></label>
    <input type="range" id="inp-x" min="-1000" max="1000" step="0.1" value="0">

    <label>Up/Down (Y): <span id="val-y" class="val">0m</span></label>
    <input type="range" id="inp-y" min="-1000" max="1000" step="0.1" value="0">
    
    <label>Fwd/Back (Z): <span id="val-z" class="val">0m</span></label>
    <input type="range" id="inp-z" min="-1000" max="1000" step="0.1" value="0">

    <label style="color:cyan; margin-top:15px; border-top:1px solid #555; padding-top:5px;">CAMERA ZOOM (Radius):</label>
    <input type="range" id="inp-rad" min="0" max="50" step="0.1" value="12.37">
</div>

<script>
    // --- PRE-FILLED DATA FROM YOUR SCREENSHOTS ---
    const savedData = {
        'sofa1': { file: 'Sofa1.glb', scale: 0.5724, x: 21.1, y: 24.3, z: 24.3, rot: 0 },
        'sofa2': { file: 'Sofa2.glb', scale: 0.3488, x: 79.6, y: 46.1, z: 51.3, rot: 0 },
        'sofa4': { file: 'Sofa4.glb', scale: 1.6382, x: 3.9, y: 2.0, z: 0.0, rot: 0 },
        'sofa5': { file: 'Sofa5.glb', scale: 1.0, x: 0, y: 0, z: 0, rot: 0 }, // NEEDS FIXING
        'sofa6': { file: 'Sofa6.glb', scale: 1.0, x: 0, y: 0, z: 0, rot: 0 }  // CHECK THIS ONE
    };

    const room = document.querySelector('#room');
    const sofa = document.querySelector('#sofa');
    const inputs = {
        sel: document.querySelector('#selector'),
        rot: document.querySelector('#inp-rot'),
        scale: document.querySelector('#inp-scale'),
        x: document.querySelector('#inp-x'),
        y: document.querySelector('#inp-y'),
        z: document.querySelector('#inp-z'),
        rad: document.querySelector('#inp-rad')
    };

    // Load Data Function
    function loadSofa(key) {
        const data = savedData[key];
        sofa.src = data.file;
        
        // Update Sliders
        inputs.scale.value = data.scale;
        inputs.x.value = data.x;
        inputs.y.value = data.y;
        inputs.z.value = data.z;
        inputs.rot.value = data.rot;
        
        update(); // Apply changes
    }

    function update() {
        const s = inputs.scale.value;
        const x = inputs.x.value; 
        const y = inputs.y.value; 
        const z = inputs.z.value;
        const r = inputs.rot.value;

        sofa.scale = `${s} ${s} ${s}`;
        sofa.cameraTarget = `${x}m ${y}m ${z}m`;
        sofa.orientation = `0deg ${r}deg 0deg`;

        // Update Labels
        document.querySelector('#val-scale').innerText = s;
        document.querySelector('#val-x').innerText = x + 'm';
        document.querySelector('#val-y').innerText = y + 'm';
        document.querySelector('#val-z').innerText = z + 'm';
        document.querySelector('#val-rot').innerText = r + ' deg';
    }

    // Sync Camera
    room.addEventListener('camera-change', () => {
        const orb = room.getCameraOrbit();
        sofa.cameraOrbit = room.cameraOrbit; 
        sofa.fieldOfView = room.fieldOfView;
        document.getElementById('inp-rad').value = orb.radius.toFixed(2);
    });
    
    // Zoom Slider
    inputs.rad.addEventListener('input', () => {
        const currentOrbit = room.getCameraOrbit();
        room.cameraOrbit = `${currentOrbit.theta}rad ${currentOrbit.phi}rad ${inputs.rad.value}m`;
    });

    Object.values(inputs).forEach(el => el.addEventListener('input', update));
    
    // Handle Selector Change
    inputs.sel.addEventListener('change', (e) => {
        loadSofa(e.target.value);
    });

    // Initialize with Sofa 1
    loadSofa('sofa1');
</script>
</body>
</html>
